{
  "name": "low_light",
  "task": "low_light",

  "model": {
    "which_model": {
      "name": ["models.model", "Model"],
      "args": {}
    },
    "networks": [
      {
        "name": ["models.cdan", "CDAN"],
        "args": {}
      }
    ]
  },

  "loss": {
    "enabled": true,
    "terms": [
      { "name": "mse", "weight": 1.0 },
      { "name": "vgg_perceptual", "weight": 0.25, "args": { "layers": 20 } },
      { "name": "ssim", "weight": 0.5 },
      { "name": "lpips", "weight": 0.5, "args": { "net": "alex" } }
    ]
  },

  "metrics": {
    "enabled": true,
    "items": [
      { "name": "psnr" },
      { "name": "ssim" },
      { "name": "lpips", "args": { "net": "alex" } }
    ]
  },

  "evaluation": {
    "raw": true,
    "postprocessed": true
  },

  "post_processing": {
    "enabled": true,
    "ops": [
      { "name": "enhance_contrast", "args": { "contrast_factor": 1.03 } },
      { "name": "enhance_color", "args": { "saturation_factor": 1.55 } }
    ]
  },

  "save_outputs": {
    "enabled": true,
    "output_dir": "outputs/low_light/",
    "max_images": 200,
    "format": "png",

    "save_raw": true,
    "save_postprocessed": true,

    "raw_prefix": "raw_",
    "post_prefix": "pp_"
  },

  "logging": {
    "enabled": true,
    "root_dir": "runs",
    "save_config_copy": true,

    "train": {
      "log_every_n_batches": 0,
      "save_csv": true,
      "save_jsonl": true
    },

    "test": {
      "save_csv": true,
      "save_jsonl": true
    },

    "checkpoints": {
      "enabled": false,
      "every_n_epochs": 10
    }
  },

  "train": {
    "device": "cuda",
    "n_epoch": 80,
    "lr": 0.001,

    "dataset": {
      "name": ["data.dataset", "PairedDataset"],
      "args": {
        "input_root": "../low_light/train/degraded",
        "target_root": "../low_light/train/clean",
        "pairing_mode": "filename",
        "transform": {
          "backend": "albumentations",
          "ops": [
            { "name": "Resize", "args": { "height": 256, "width": 384 } },
            { "name": "HorizontalFlip", "args": { "p": 0.5 } },
            { "name": "VerticalFlip", "args": { "p": 0.15 } },
            { "name": "RandomRotate90", "args": { "p": 0.1 } },
            { "name": "RandomGamma", "args": { "gamma_limit": [70, 130], "p": 0.2 } },
            { "name": "RandomBrightnessContrast", "args": { "brightness_limit": 0.1, "contrast_limit": 0.1, "p": 0.25 }},
            { "name": "Normalize", "args": { "mean": [0.0, 0.0, 0.0], "std": [1.0, 1.0, 1.0] } },
            { "name": "ToTensorV2", "args": {} }
          ]
        }

      }
    },

    "dataloader": {
      "args": {
        "batch_size": 16,
        "shuffle": true,
        "num_workers": 4
      }
    },

    "model_path": "weights/",
    "model_name": "CDAN_low_light.pt"
  },

  "test": {
    "device": "cuda",

    "dataset": {
      "name": ["data.dataset", "PairedDataset"],
      "args": {
        "input_root": "../low_light/test/degraded",
        "target_root": "../low_light/test/clean",
        "pairing_mode": "filename",
        "transform": {
          "backend": "albumentations",
          "ops": [
            { "name": "Resize", "args": { "height": 256, "width": 384 } },
            { "name": "Normalize", "args": { "mean": [0.0, 0.0, 0.0], "std": [1.0, 1.0, 1.0] } },
            { "name": "ToTensorV2", "args": {} }
          ]
        }
      },
      "is_paired": true
    },

    "dataloader": {
      "args": {
        "batch_size": 16,
        "shuffle": false,
        "num_workers": 4
      }
    },

    "model_path": "weights/",
    "model_name": "CDAN_low_light.pt",
    "output_images_path": "outputs/low_light/"
  }
}
